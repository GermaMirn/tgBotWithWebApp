# Платформа для студии английского языка

**Микросервисная платформа** для автоматизации бизнес-процессов и предоставления цифровых сервисов студии английского языка

---
#### О проекте
Данная платформа представляет собой высокомасштабируемое и отказоустойчивое, разработанное для комплексной автоматизации работы языковой студии. Система декомпозирована на независимые сервисы, что обеспечивает гибкость разработки, простоту поддержки и возможность независимого масштабирования отдельных компонентов под нагрузкой.

Проект призван заменить монолитные и разрозненные инструменты, предоставив единую, интегрированную экосистему для администраторов, преподавателей и студентов.

---
#### Цель
Повышения эффективности бизнес-операций, улучшения качества обслуживания клиентов и создание персонализированного, удобного опыта для всех участников образовательного процесса через предоставление надежных и современных цифровых сервисов

---
#### Архитектура проекта и ключевые сервисы

![Архитектура микросервисной платформы](docs/images/TgBot.png)

| Сервис                      | Назначение                                                                                                                                        | Технологии                                              |
| --------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------- |
| **`auth-service`**          | **Центр аутентификации и авторизации.** Выпуск JWT-токенов, управление сессиями, интеграция с OAuth 2.0 провайдерами.                             | Python, Fast api, JWT, PostgreSQL, REST API             |
| **`bff-service`**           | **Backend For Frontend.** Агрегатор данных из различных сервисов для конкретного клиента (Web, Mobile), обеспечивая оптимальную работу фронтенда. | Python, Fast api, JWT, PostgreSQL, REST API             |
| **`calendary-service`**     | **Хранилище событий и расписаний.** Управление личными и групповыми расписаниями преподавателей, проверка доступности "слотов".                   | Python, Fast api, PostgreSQL, REST API                  |
| **`frontend-service`**      | **Веб-интерфейс платформы.** Клиентское приложение, предоставляющее интерфейсы для студентов, учителей и админов.                                 | Vue, Vite, TypeScript, Prime vue, Pinia                        |
| **`groups-service`**        | **Домен групп.** Управление жизненным циклом учебных групп: создание, редактирование, состав, история перемещений.                                | Python, Fast api, PostgreSQL, REST API                  |
| **`lessons-service`**       | **Ядро учебного процесса.** Фиксация проведенных и запланированных уроков, привязка к расписанию, ведение журнала посещений.                      | Python, Fast api, PostgreSQL, REST API                  |
| **`notifications-service`** | **Единый шлюз коммуникаций.** Отправка email, SMS и push-уведомлений (напоминания о уроках, новости, платежи).                                    | Python, Fast api, PostgreSQL, RabbitMQ, Redis, REST API |
| **`students-service`**      | **Профили студентов.** Учет контактов, история обучения, баланс платежей, прогресс и прикрепленные документы.                                     | Python, Fast api, PostgreSQL, REST API                  |
| **`teachers-service`**      | **Профили преподавателей.** Учетная информация, расписание, ставки, связь с проведенными уроками и группами.                                      | Python, Fast api, PostgreSQL, REST API                  |
| **`tg-bot-service`**        | **Точка входа в Telegram.** Автоматизация запросов на пробные уроки, quick-напоминания, обратная связь.                                           | Python, aiogram, RabbitMQ, Redis                        |

**`Коммуникация`**: REST API, RabbitMQ
**`Инфраструктура`**: Docker, Docker Compose, Nginx
**`Мониторинг`**: -
**`Документирование`**: Mark down, Swagger (OpenAPI)
**`CI/CD`**:

---
#### Локальный запуск
Перед первым запуском необходимо выполнить предварительную настройку и получить необходимые учетные данные

**Предварительные требования**
1. **Аккаунт в CloudPub**: зарегистрируйтесь на платформе CloudPub и получите токен доступа.
2. **Telegram Bot**: Создайте бота через BotFather и сохраните полученный токен.

**Настройка переменных окружения**
Конфигурация системы осуществляется через переменные окружения. Для каждого сервиса необходимо создать соответствующи `.env` файл.

1. Общие настройки (корень проекта):
```bash
CLOUDPUB_TOKEN=CLOUDPUB_TOKEN
```

2. Настройки сервисов:

|Сервис|Путь к .env|Пример содержимого|
|---|---|---|
|**tg-bot-service**|`/tg-bot-service/.env`|`BOT_TOKEN=your_telegram_bot_token`|
|**auth-service**|`/auth-service/.env`|`SECRET_KEY=your_jwt_secret`  <br>`ACCESS_TOKEN_EXPIRE_MINUTES=30`  <br>`DB_HOST=auth_db`  <br>`POSTGRES_DB=auth_db`  <br>`POSTGRES_USER=user`  <br>`POSTGRES_PASSWORD=password`|
|**bff-service**|`/bff-service/.env`|`SECRET_KEY=your_bff_secret_key`|
|**Сервисы с БД**  <br>(teachers, students,  <br>notifications, lessons,  <br>groups, calendary)|`/{service-name}/.env`|`DB_HOST=db_service_name`  <br>`POSTGRES_DB=db_name`  <br>`POSTGRES_USER=user`  <br>`POSTGRES_PASSWORD=password`|
Примечание: Для сервисов, использующих PostgreSQL (teachers, students и др.), значения `DB_HOST` обычно соответствуют именам сервисов в `docker-compose.yml` (напр., `teachers-db`)

**Процесс запуска**
Выполните следующие команды в терминале из корневой директории проекта:

1.  **Запуск CludPub**:
```bash
# Собираем и запускаем только cloudpub в фоновом режиме
docker compose up --build -d cloudpub
```
После запуска нужно скопировать сгенерированный домен сетевого интерфейса в интернет из логов контейнера.

2. **Настройка Telegram Webhook**:
Зайдите в созданного бота в Telegram и установите полученный на предыдущем шаге URL в качестве адреса для вебхука.

3. Запуск всей системы:
```bash
# Собираем и запускаем все сервисы
docker compose up --build
```

Для остановки всех сервисов используйте Control + c в терминале

